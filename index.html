<html>
  <head>
        <script src="https://konverz.vox-cpaas.com/js/jquery.min.js"></script>
  <script src="https://konverz.vox-cpaas.com/js/bootstrap.min.js"></script>
  <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
  <script src="https://konverz.vox-cpaas.com/js/protobuf.min.js"></script>
  <script src="https://sdk.amazonaws.com/js/aws-sdk-2.154.0.min.js"></script>
  <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async></script>
  <script src="https://konverz.vox-cpaas.com/js/calmsdk-001.js"></script>
  <script src="https://konverz.vox-cpaas.com/js/wrtc.js"></script>
  <script src="https://konverz.vox-cpaas.com/js/sha256.js"></script>
    <style>

.online {
  height: 25px;
  width: 25px;
  background-color: #0f0;
  border-radius: 50%;
  display: inline-block;
}

.offline {
  height: 25px;
  width: 25px;
  background-color: #f00;
  border-radius: 50%;
  display: inline-block;
}
    </style>
    <script>

     var callid = '', is_muted= false;

     /* Initiate outbound call (call remote party) */
     function start(destnum) {
        document.getElementById("end").style.visibility = "visible";
        document.getElementById("mute").style.visibility = "visible";
        callid = CS.call.startPSTNCall(destnum, "localVideo", "remoteVideo", function(){});
     }

     /* End ongoing call */
     function endCall() {
        document.getElementById("end").style.visibility = "hidden";
        document.getElementById("mute").style.visibility = "hidden";

        CS.call.end(callid, "Bye", function(ret, resp) {
          if (ret == 200)
              console.log("call end successfully");
        });
     }

     /* Mute call */
     function mute() {
       is_muted = !is_muted;
       CS.call.mute(callid, is_muted, function(ret, resp) {
          if ( ret == 200 ) 
            console.log("Call muted successfully");
       }); 


       if(is_muted)
         document.getElementById("mute").value="un-mute call"; 
       else
         document.getElementById("mute").value="mute call"; 
     }

     /* On document load initiate sdk initialization and login */
     function pageload() { // Initializes the sdk and logs in the user.
       document.getElementById("end").style.visibility = "hidden";
       document.getElementById("mute").style.visibility = "hidden";
       document.getElementById("start").style.visibility = "hidden";

       CS.call.onMessage(handleCallFromIML);

       // configuration parameters. 
       let config = {
                       appId:"pid_cda42874_d665_43a0_a5b3_f1cc46721e05" //<--- insert your project id here
                    };

        // callback called at the end of initialization to notify success or failure.
        function callback(ret, resp){
          if (ret == 200) {
             console.log("SDK "+CS.version+" initialized ");

             // Initiate login request
             CS.login("amen160@gmail.com", "Abcde12345-", function(err, resp){
               if (err == 200) {
                 console.log("Login succesful");
                 document.getElementById("start").style.visibility = "visible";
               }
             });
          }
         }
        CS.initialize(config, callback);
     }

      function handleCallFromIML(msgType, resp) {
        switch(msgType) {
          case "OFFER":     /* incoming offer from remote party */
          break;
          case "PSTN-OFFER":
            console.log("PSTN incoming call offer");
          break;
          case "RINGING":   /* ringing */
          break;
          case "ANSWERED":  /* call answer */
          break;
          case "END":       /* call end */
            console.log("call end");
            document.getElementById("end").style.visibility = "hidden";
            document.getElementById("mute").style.visibility = "hidden";
          break;
          case "PSTN-END":
            console.log("PSTN incoming call end");
          break;
        }
      }
    </script>
  </head>
<body onload=pageload()>
  <input type="button" onclick="start('conmeo1')" id="start" value="Call conmeo1"></input>
  <input type="button" onclick="endCall()" id="end" value="end call"></input>
  <input type="button" onclick="mute()" id="mute" value="mute call"></input>
  <video id="localVideo" autoplay muted style="display: none;"></video>
  <video id="remoteVideo" autoplay width="200px" height="180px" style="display: none;"></video>
</body>